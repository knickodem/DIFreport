---
title: "Measurement Bias Analysis of [Outcome] by [Grouping Variable] in [Dataset]"
output:
  html_document:
    toc: yes
always_allow_html: yes
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(knitr)
library(rmarkdown)
library(xtable)

source("DIF_Methods_Functions.R")
source("DIF_Methods_Wrappers.R")
source("Measure_Level_Wrapper.R")

```
# Summary

(Note: this could all be pretty printed from the DIF_analysis function)

Dataset: Name of study from SIEF microdata website
Outcome variable: [assessment name (item codes)]
Grouping variable: [variable name (levels)]
Bias detection method: [MH / logistic regression / IRT]
Total number of biased items: [n_biased out of N_total]
  Type of item bias: [uniform / nonuniform] 
    Number of items uniformly biased toward [level1]: 
    Number of items uniformly biased toward [level2]: 
  Summary table for robustness of treatment effects: [insert table] 


```{r Analysis, echo = FALSE, include = FALSE}

## Conducting the DIF analysis
DIF_Results <- DIF_analysis(MeasureData = NumberRecog_Treated$MeasureData,
                                        groupvec = NumberRecog_Treated$GroupVector,
                                        scoreType = "Total", methods = c("loess", "MH", "logistic", "IRT"),
                                        MHstrata = tenths)

```



Supplemental text:
How were the bias items detected?

# Descriptive analyis via Loess

```{r loess}
print(DIF_Results$loess$plot)
```

# Item-level inferences

## Mantel-Haenszel

```{r MH}
xtable(DIF_Results$MH, digits = 2)
```

## Logistic Regression

```{r Logistic Global}
xtable(DIF_Results$logistic$Global, digits = 2)
```


```{r Logistic Item}
xtable(DIF_Results$logistic$Item, digits = 2)
```

## Item Response Theory


```{r IRT Global}
xtable(DIF_Results$IRT$Global, digits = 2)
```


```{r IRT Item}
xtable(DIF_Results$IRT$Item, digits = 2)
```

